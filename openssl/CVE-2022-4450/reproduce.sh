#!/bin/bash

IMAGE=openssl-cve-2022-4450
VERSION="3.0.0"

if ! docker image inspect "${IMAGE}" &> /dev/null; then
    docker build --build-arg version=${VERSION} --network=host --build-arg HTTP_PROXY=http://127.0.0.1:7890 --build-arg HTTPS_PROXY=http://127.0.0.1:7890 -t ${IMAGE} .
fi

echo "[+] Running openssl asn1parse"
docker run --rm -v $PWD/poc:/poc:ro -it ${IMAGE} openssl asn1parse -in /poc -out /poc-out
