IMAGE=wolfssl-cve-2022-42905
WOLFSSL_VERSION=$1

if ! docker image inspect "${IMAGE}" &> /dev/null; then
    cmd="docker build -t $IMAGE --build-arg WOLFSSL_VERSION=$WOLFSSL_VERSION --network=host --build-arg HTTP_PROXY=http://127.0.0.1:7890 --build-arg HTTPS_PROXY=http://127.0.0.1:7890 ."
    echo "[+] Running: $cmd"
    eval $cmd
fi

echo "[+] Running container"
docker run --rm -v -it $IMAGE
